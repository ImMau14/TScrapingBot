# ğŸ•¸ TScrapingBot 1.4.0

![Python](https://img.shields.io/badge/Python-001f2d?style=for-the-badge\&logo=python)
![Telegram](https://img.shields.io/badge/Telegram-041453?style=for-the-badge\&logo=telegram\&logoColor=046dac)
![Flask](https://img.shields.io/badge/Flask-010101?style=for-the-badge\&logo=flask)
![Gemini](https://img.shields.io/badge/Gemini-00436b?style=for-the-badge\&logo=googlegemini\&logoColor=white)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-27273e?style=for-the-badge\&logo=postgresql)
![Requests](https://img.shields.io/badge/Requests-white?style=for-the-badge\&logo=python\&logoColor=black)
![Beautiful Soup](https://img.shields.io/badge/Beautiful%20Soup-black?style=for-the-badge\&logo=python\&logoColor=white)

Un bot de Telegram para web scraping potenciado con inteligencia artificial. Clic aquÃ­ para usarlo en Telegram: [@TScrapingBot](https://t.me/TScrapingBot)

*[Readme in English](./README_ENG.md)*

## ğŸŒŸ CaracterÃ­sticas

### âœ… Actuales

* Respuestas de texto generadas por Gemini 2.0.
* AnÃ¡lisis de imagen.
* Fetching y anÃ¡lisis de contenido de URL's.
* Memoria en chats (solo comandos `/ask` y `/search`).
* Obtener el precio del USD en VES.

### ğŸ”® Futuras

* GeneraciÃ³n de imÃ¡genes.
* ConversaciÃ³n mediante audios.
* Chats colectivos en grupos.
* Procesar documentos de texto y archivos de video.
* Obtener el clima.
* Navegar entre repositorios de GitHub.

## ğŸ“œ Comandos

|          Comando         |                      AcciÃ³n                     |
| :----------------------: | :---------------------------------------------: |
|         `/start`         |                Comando de inicio                |
|          `/ping`         |   Comando para saber si el bot estÃ¡ despierto   |
|          `/help`         |         Muestra los comandos disponibles        |
|         `/dolar`         | Muestra el precio actual del dÃ³lar en bolÃ­vares |
|      `/ask <prompt>`     |                Pregunta a Gemini                |
|         `/reset`         |          Resetea el historial de chat           |
| `/search <url> <prompt>` |  Busca en la URL y pregunta a Gemini sobre eso  |

## ğŸš€ Despliegue

### âš™ï¸ Requisitos

* Python 3.11.\* (o superior).
* API key de [Gemini 2.0](https://ai.google.dev/).
* Crear un bot con [@BotFather](https://t.me/BotFather) y obtener su token (en Telegram).
* Token de [Scrape.do](https://scrape.do/).
* Base de datos, Token y URL de [Supabase](https://supabase.com).

### ğŸ—ƒï¸ Base de Datos

Debe de tener esta estructura (cÃ³digo SQL en [schema.sql](data/schema.sql)):

![Diagrama de Supabase](https://files.catbox.moe/a1xva7.png)

### ğŸ” Variables de Entorno

#### ğŸ§± BÃ¡sicas

|     Variable     |         Valor         |
| :--------------: | :-------------------: |
|  `GEMINI_TOKEN`  |   Tu token de Gemini  |
| `SCRAPEDO_TOKEN` | Tu token de Scrape.do |
|  `SUPABASE_KEY`  |  Tu token de Supabase |
|  `SUPABASE_URL`  |   Tu URL de Supabase  |
| `TELEGRAM_TOKEN` |  Tu token de Telegram |

#### ğŸ› ï¸ Para ProducciÃ³n

|    Variable   |     Valor    |
| :-----------: | :----------: |
|   `HOSTING`   |    `true`    |
| `WEBHOOK_URL` | URL del host |

### ğŸ“¦ InstalaciÃ³n

**En estos pasos se asume que ya se ha creado la base de datos.**

1. Clona y entra en el repositorio:

```bash
git clone https://github.com/ImMau14/TScrapingBot
cd TScrapingBot
```

2. Inicia un entorno virtual e instala las dependencias:

```bash
# En Linux/macOS
python3 -m venv env
source env/bin/activate
pip install -r requirements.txt
```

```bash
# En Windows
python -m venv env
.\env\Scripts\activate
pip install -r requirements.txt
```

3. Copia y configura las variables de entorno.

```bash
cp .env.template .env
nano .env # O el editor de tu preferencia.
```

4. Enciende el bot:

```bash
# En Linux/macOS
python3 main.py
```

```bash
# En Windows
python main.py
```

## ğŸ—‚ï¸ Estructura

```
TScrapingBot/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ gemini_config.json    # Modos de configuraciÃ³n de Gemini
â”‚   â”œâ”€â”€ messages.json         # Mensajes del bot
â”‚   â””â”€â”€ schema.sql            # Tablas de la base de datos
â”œâ”€â”€ modules/
â”‚   â”œâ”€â”€ database.py           # Funciones de base de datos
â”‚   â”œâ”€â”€ dolar_scraper.py      # FunciÃ³n scraper del dÃ³lar
â”‚   â”œâ”€â”€ gemini.py             # Clase manejadora de Gemini
â”‚   â”œâ”€â”€ page_scraper.py       # FunciÃ³n scraper de webs
â”‚   â””â”€â”€ utils.py              # Funciones Ãºtiles
â”œâ”€â”€ main.py                   # Archivo principal (bot)
â”œâ”€â”€ requirements.txt          # Dependencias
â”œâ”€â”€ .env.template             # Plantilla de variables de entorno
â”œâ”€â”€ .gitignore                # Git Ignore
â”œâ”€â”€ README_ENG.md             # README en inglÃ©s
â”œâ”€â”€ README.MD                 # README en espaÃ±ol
â””â”€â”€ LICENSE                   # Licencia MIT
```

## â˜ï¸ Desplegado En

* Host: [Render](https://render.com).
* Base de datos: [Supabase](https://supabase.com).

## ğŸ“œ Licencia

Este proyecto estÃ¡ licenciado bajo la Licencia MIT - ver el archivo [LICENSE](LICENSE) para mÃ¡s detalles.
